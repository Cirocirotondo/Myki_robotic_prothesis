nMag = 4;
% nCOM = [23, 24, 22, 20];
% nCOM = [20, 22, 23, 24];
nCOM = 12;%[12 5 6 13];
nBoards = size(nCOM, 2);
% x0 = [0.01, 0.02, 0.018, 0.01, 0.01, 0.9, ...
%       0.03, 0.02, 0.01, 0.01, 0.01, -0.9, ...
%       0.04, 0.08, 0.02, 0.01, 0.01, -0.9  ...
%       0.05, 0.01, 0.01, 0.01, 0.01,  0.9, ...
%       0.03, 0.05, 0.02, 0.01, 0.01,  0.9];

boardsPosePLAIN= [        0,      0,      0,    0,    0,    0;
                       44.5,      0,    1.5,    0,    0,    0;
                     44.5*2,      0,      0,    0,    0,    0;
                     44.5*3,      0,    1.5,    0,    0,    0;
                     44.5*4,      0,      0,    0,    0,    0];

boardsPoseTOWER= [      0,      0,       0,    0,    0,    0;
                        0,      0,    11.5,    0,    0,    0;
                        0,      0,  11.5*2,    0,    0,    0;
                        0,      0,  11.5*3,    0,    0,    0;
                        0,      0,  11.5*4,    0,    0,    0];

boardsPoseCROSS= [      0,             0,       0,    0,    0,    0;
                        -44.5,         0,       2.57,    0,    0,    90;
                        -44.5,     -44.5,     2.57*2,    0,    0,    180;
                            0,     -44.5,     2.57*3,    0,    0,    270];

boardsPoseMOKUP= [     38.6,      0,   92.4,    0,  180,    0;
                          0,      0,      0,    0,    0,    0;
                      -32.1,      0,   71.4,    0,  270,    0;
                       69.3,      0,   30.8,    0,   90,    0];

boardsPose = boardsPoseMOKUP;
clear boardsPosePLAIN boardsPoseTOWER boardsPoseCROSS boardsPoseMOKUP
boardsPose(:,1:3) = boardsPose(:,1:3)/1000;

sens2ignore = [2 7; 3 8; 3 32; 4 32];%[1,7; 3,32; 4,8; 4,32];    % sensors to be ignored [#board, #sensor]
mrg = 0.03; % [m] bound margin

sPos_wrtBoard = [ 5.5,    4,    0;  ...    % 1
                  5.5,    13,   0;  ...
                  5.5,    22,   0;  ...
                  5.5,    31,   0;  ...
                  5.5,    40,   0;  ...
                  5.5,    49,   0;  ...
                  5.5,    58,   0;  ...    %7
                  5.5,    67,   0;  ...    %8
%                   11.4,    115.9,    0;  ...    %8far
                  14.5,   4,    0;  ...    %9
                  14.5,   13,   0;  ...
                  14.5,   22,   0;  ...
                  14.5,   31,   0;  ...
                  14.5,   40,   0;  ...
                  14.5,   49,   0;  ...
                  14.5,   58,   0;  ...
                  14.5,   67,   0;  ...    %16
                  23.5,   4,    0;  ...    %17
                  23.5,   13,   0;  ...
                  23.5,   22,   0;  ...
                  23.5,   31,   0;  ...
                  23.5,   40,   0;  ...
                  23.5,   49,   0;  ...
                  23.5,   58,   0;  ...
                  23.5,   67,   0;  ...    %24
                  32.5,   4,    0;  ...    %25
                  32.5,   13,   0;  ...
                  32.5,   22,   0;  ...
                  32.5,   31,   0;  ...
                  32.5,   40,   0;  ...
                  32.5,   49,   0;  ...
                  32.5,   58,   0;  ...    %31
                  32.5,   67,   0 ]/1000; %32
%                   27.2,    115.9,    0]/1000; % 32far


sPos = positionateSensors(sPos_wrtBoard, boardsPose, nBoards);

x = rand_x0(nMag,sPos, 20);
% actualPositions = [       35.45,      26.3494,      23.4,    0,    0,    -1000;
%                           47.95,           48,      23.4,    0,    0,    -1000;
%                           60.45,      26.3494,      23.4,    0,    0,    -1000;
%                           72.95,           48,      23.4,    0,    0,    -1000;
%                           85.45,      26.3494,      23.4,    0,    0,    -1000;
%                           97.95,           48,      23.4,    0,    0,    -1000;
%                          110.45,      26.3494,      23.4,    0,    0,    -1000;
%                          122.95,           48,      23.4,    0,    0,    -1000;
%                          135.45,      26.3494,      23.4,    0,    0,    -1000]/1000;

actualPositions = [       21.5,      13,      18,    0,    0,    -1000;
                          14.5,           31,      18,    0,    0,    -1000;
                         58,      18,      18,    0,    0,    -1000]/1000;
% x = actualPositions;

% bounds = [min(sPos(:,1))-mrg, max(sPos(:,1))+mrg, min(sPos(:,2))-mrg, max(sPos(:,2))+mrg, min(sPos(:,3)), max(sPos(:,3))+mrg];
bounds = [min(sPos(:,1))-mrg, max(sPos(:,1))+mrg, min(sPos(:,2))-mrg, max(sPos(:,2))+mrg, min(sPos(:,3))-mrg, max(sPos(:,3))+mrg];

scia = 10;
xVisold = zeros(scia, 6);
